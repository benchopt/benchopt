{% extends "!layout.html" %}

{% block footer %}
<div style="margin-top: 1em;">
  <label for="version-select">Version:</label>
  <select id="version-select"></select>
</div>

<script>
fetch("{{ pathto('', 1) }}versions.json")
  .then(response => response.json())
  .then(data => {
    const select = document.getElementById("version-select");
    const current = window.location.pathname.split('/')[1];  // e.g. "dev" or "v1.2"

    // Stable and dev first
    ["stable", "dev"].forEach(name => {
      const opt = document.createElement("option");
      opt.value = "/" + name + "/";
      opt.text = name;
      if (current === name) opt.selected = true;
      select.appendChild(opt);
    });

    // Then all versions
    data.versions.forEach(v => {
      const opt = document.createElement("option");
      opt.value = "/" + v + "/";
      opt.text = v;
      if (current === v) opt.selected = true;
      select.appendChild(opt);
    });

    select.onchange = function() {
      window.location.href = select.value;
    };
  });
</script>

{{ super() }}
{% endblock %}
