<%
    benchmark_name = benchmark.replace("benchmark_", "").replace("_", " ")
%>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“ˆ</text></svg>">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Result on ${benchmark_name} benchmark</title>

        <style>
            ${result['main.css']}

            ${result['hover_index.css']}
        </style>
    </head>
    <body>
        <a id="top"></a>
        <a href="${home}">
            <button class="btn">
                ${result['home.svg']}
            </button>
        </a>
        <a href="${benchmark}.html">
            <button class="btn">
                ${result['arrow_left.svg']}
                <span>
                    ${benchmark_name}
                </span>
            </button>
        </a>
        <a href="${result['fname']}">
            <button class="btn">
                ${result['download.svg']}
                <span>
                    ${result["fname_short"]}
                </span>
            </button>
        </a>
        <h1 style:>Result on ${benchmark_name} benchmark</h1>
        <summary></summary>

        <!--Display all system informations if you want to-->
        % if any([val != "" for _, val in result['sysinfo']['sub'].items()]):
        <p>System informations:
            % for name, val in result['sysinfo']['main'].items():
            % if val != "":
            <b>${name.upper()}</b>: ${val}
            % endif
            % endfor
            <button id="btn_subinfo" class="button buttonleft toggle">
                <svg id="btn_plus" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256 368C269.3 368 280 357.3 280 344V280H344C357.3 280 368 269.3 368 256C368 242.7 357.3 232 344 232H280V168C280 154.7 269.3 144 256 144C242.7 144 232 154.7 232 168V232H168C154.7 232 144 242.7 144 256C144 269.3 154.7 280 168 280H232V344C232 357.3 242.7 368 256 368z"/></svg>
                <svg id="btn_minus" style="display: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM168 232C154.7 232 144 242.7 144 256C144 269.3 154.7 280 168 280H344C357.3 280 368 269.3 368 256C368 242.7 357.3 232 344 232H168z"/></svg>
            </button>
            <div id="subinfo" style="display:none;transition: 0.5s;">
                <ul>
                    % for key_sub, val_sub in result['sysinfo']['sub'].items():
                    % if val_sub != "":
                    <li> <b>${key_sub}</b>: ${val_sub} </li>
                    % endif
                    %endfor
                    % for key_ter, val_ter in result['sysinfo']['ter'].items():
                    % if val_ter != "":
                    <%
                    val = val_ter.split()
                    val = [''.join(l for l in item if l.isalnum() or l in [".", "_", '=']) for item in val]
                    val = " ".join(val)
                %>
                    <li> <b>${key_ter}</b>: ${val} </li>
                    % endif
                    %endfor
                </ul>
            </div>
        </p>
        %endif


        <!-- Add selector to display only one plot -->
        <div>
            <label for='dataset_selector'>Dataset:</label>
            <select id='dataset_selector' onchange="setState({dataset: this.value});">
                % for data in result['dataset_names']:
                <option value="${data}">${data}</option>
                %endfor
            </select>
        </div>
        <div>
            <label for='objective_selector'>Objective:</label>
            <select id='objective_selector' onchange="setState({objective: this.value});">
                % for obj in result['objective_names']:
                <option value="${obj}">${obj}</option>
                %endfor
            </select>
            <select id='objective_column' onchange="setState({objective_column: this.value});">
                % for obj_col in result['obj_cols']:
                <option value="${obj_col}">${obj_col.replace('objective_', '')}</option>
                %endfor
            </select>
        </div>
        <div>
            <label for='plot_kind'>Chart type:</label>
            <select id='plot_kind' onchange="setState({plot_kind: this.value});">
                % for kind in result['kinds']:
                <option value="${kind}">${kind.replace('_', ' ')}</option>
                %endfor
            </select>
            <select id="change_scaling" onchange="setState({scale: this.value});">
                <option value="semilog-y">semilog-y</option>
                <option value="semilog-x">semilog-x</option>
                <option value="loglog">loglog</option>
                <option value="linear">linear</option>
            </select>
        </div>
        <div style="display: flex; align-items: center;">
            <p style="margin: 0; margin-right: 4px">Quantiles: </p>
            <label for='change_shades' class="switch">
                <input id="change_shades" type="checkbox" checked onchange="setState({with_quantiles: this.checked})">
                <span class="slider round"></span>
            </label>
        </div>

        <div id="unique_plot"></div>

        <div id="legend_title">
            Solvers <span id="legend_help">(Click on a solver to hide it or double click to hide all the others)</span>
        </div>
        <div id="plot_legend" class="space-r-4"></div>

        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>
        <script>
            window.data = ${result['json']};

            window.addEventListener("load", () => {
                // Initialize plot state
                setState({
                    'dataset': document.getElementById('dataset_selector').value,
                    'objective': document.getElementById('objective_selector').value,
                    'objective_column': document.getElementById('objective_column').value,
                    'plot_kind': document.getElementById('plot_kind').value,
                    'scale': document.getElementById('change_scaling').value,
                    'with_quantiles': document.getElementById('change_shades').checked,
                    'hidden_solvers': []
                });
            });
        </script>
        <script type="text/javascript">
            ${result['symbols.js']}
            ${result['result.js']}
        </script>
    </body>
</html>
