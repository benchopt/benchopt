<%
    benchmark_name = benchmark.replace("benchmark_", "").replace("_", " ")
%>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“ˆ</text></svg>">
        <link href="${static_dir}/main.css" rel="stylesheet" />
        <link href="${static_dir}/hover_index.css" rel="stylesheet" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Result on ${benchmark_name} benchmark</title>
    </head>
    <body>
        <a id="top"></a>
        <a href="${home}">
            <button class="btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" viewBox="0 0 576 512"><path d="M511.8 287.6L512.5 447.7C512.5 450.5 512.3 453.1 512 455.8V472C512 494.1 494.1 512 472 512H456C454.9 512 453.8 511.1 452.7 511.9C451.3 511.1 449.9 512 448.5 512H392C369.9 512 352 494.1 352 472V384C352 366.3 337.7 352 320 352H256C238.3 352 224 366.3 224 384V472C224 494.1 206.1 512 184 512H128.1C126.6 512 125.1 511.9 123.6 511.8C122.4 511.9 121.2 512 120 512H104C81.91 512 64 494.1 64 472V360C64 359.1 64.03 358.1 64.09 357.2V287.6H32.05C14.02 287.6 0 273.5 0 255.5C0 246.5 3.004 238.5 10.01 231.5L266.4 8.016C273.4 1.002 281.4 0 288.4 0C295.4 0 303.4 2.004 309.5 7.014L416 100.7V64C416 46.33 430.3 32 448 32H480C497.7 32 512 46.33 512 64V185L564.8 231.5C572.8 238.5 576.9 246.5 575.8 255.5C575.8 273.5 560.8 287.6 543.8 287.6L511.8 287.6z"/></svg>
            </button>
        </a>
        <a href="${benchmark}.html">
            <button class="btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" viewBox="0 0 448 512"><path d="M447.1 256C447.1 273.7 433.7 288 416 288H109.3l105.4 105.4c12.5 12.5 12.5 32.75 0 45.25C208.4 444.9 200.2 448 192 448s-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25l160-160c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L109.3 224H416C433.7 224 447.1 238.3 447.1 256z"/></svg>
                <span>
                    ${benchmark_name}
                </span>
            </button>
        </a>
        <a href="${result['fname']}">
            <button class="btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" viewBox="0 0 512 512"><path d="M480 352h-133.5l-45.25 45.25C289.2 409.3 273.1 416 256 416s-33.16-6.656-45.25-18.75L165.5 352H32c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h448c17.67 0 32-14.33 32-32v-96C512 366.3 497.7 352 480 352zM432 456c-13.2 0-24-10.8-24-24c0-13.2 10.8-24 24-24s24 10.8 24 24C456 445.2 445.2 456 432 456zM233.4 374.6C239.6 380.9 247.8 384 256 384s16.38-3.125 22.62-9.375l128-128c12.49-12.5 12.49-32.75 0-45.25c-12.5-12.5-32.76-12.5-45.25 0L288 274.8V32c0-17.67-14.33-32-32-32C238.3 0 224 14.33 224 32v242.8L150.6 201.4c-12.49-12.5-32.75-12.5-45.25 0c-12.49 12.5-12.49 32.75 0 45.25L233.4 374.6z"/></svg>
                <span>
                    ${result["fname_short"]}
                </span>
            </button>
        </a>
        <h1 style:>Result on ${benchmark_name} benchmark</h1>
        <summary></summary>

        <!--Display all system informations if you want to-->
        % if any([val != "" for _, val in result['sysinfo']['sub'].items()]):
        <p>System informations:
            % for name, val in result['sysinfo']['main'].items():
            % if val != "":
            <b>${name.upper()}</b>: ${val}
            % endif
            % endfor
            <button id="btn_subinfo" class="button buttonleft toggle">
                <svg id="btn_plus" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256 368C269.3 368 280 357.3 280 344V280H344C357.3 280 368 269.3 368 256C368 242.7 357.3 232 344 232H280V168C280 154.7 269.3 144 256 144C242.7 144 232 154.7 232 168V232H168C154.7 232 144 242.7 144 256C144 269.3 154.7 280 168 280H232V344C232 357.3 242.7 368 256 368z"/></svg>
                <svg id="btn_minus" style="display: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM168 232C154.7 232 144 242.7 144 256C144 269.3 154.7 280 168 280H344C357.3 280 368 269.3 368 256C368 242.7 357.3 232 344 232H168z"/></svg>
            </button>
            <div id="subinfo" style="display:none;transition: 0.5s;">
                <ul>
                    % for key_sub, val_sub in result['sysinfo']['sub'].items():
                    % if val_sub != "":
                    <li> <b>${key_sub}</b>: ${val_sub} </li>
                    % endif
                    %endfor
                    % for key_ter, val_ter in result['sysinfo']['ter'].items():
                    % if val_ter != "":
                    <%
                    val = val_ter.split()
                    val = [''.join(l for l in item if l.isalnum() or l in [".", "_", '=']) for item in val]
                    val = " ".join(val)
                %>
                    <li> <b>${key_ter}</b>: ${val} </li>
                    % endif
                    %endfor
                </ul>
            </div>
        </p>
        %endif


        <!-- Add selector to display only one plot -->
        <div>
            <label for='dataset_selector'>Dataset:</label>
            <select id='dataset_selector' onchange="setState({dataset: this.value});">
                % for data in result['dataset_names']:
                <option value="${data}">${data}</option>
                %endfor
            </select>
        </div>
        <div>
            <label for='objective_selector'>Objective:</label>
            <select id='objective_selector' onchange="setState({objective: this.value});">
                % for obj in result['objective_names']:
                <option value="${obj}">${obj}</option>
                %endfor
            </select>
            <select id='objective_column' onchange="setState({objective_column: this.value});">
                % for obj_col in result['obj_cols']:
                <option value="${obj_col}">${obj_col.replace('objective_', '')}</option>
                %endfor
            </select>
        </div>
        <div>
            <label for='plot_kind'>Chart type:</label>
            <select id='plot_kind' onchange="setState({plot_kind: this.value});">
                % for kind in result['kinds']:
                <option value="${kind}">${kind.replace('_', ' ')}</option>
                %endfor
            </select>
            <select id="change_scaling" onchange="setState({scale: this.value});">
                <option value="semilog-y">semilog-y</option>
                <option value="semilog-x">semilog-x</option>
                <option value="loglog">loglog</option>
                <option value="linear">linear</option>
            </select>
        </div>
        <div style="display: flex; align-items: center;">
            <p style="margin: 0; margin-right: 4px">Quantiles: </p>
            <label for='change_shades' class="switch">
                <input id="change_shades" type="checkbox" checked onchange="setState({with_quantiles: this.checked})">
                <span class="slider round"></span>
            </label>
        </div>

        <div id="unique_plot"></div>

        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>
        <script>
            window.data = ${result['json']};

            window.addEventListener("load", () => {
                // Initialize plot state
                setState({
                    'dataset': document.getElementById('dataset_selector').value,
                    'objective': document.getElementById('objective_selector').value,
                    'objective_column': document.getElementById('objective_column').value,
                    'plot_kind': document.getElementById('plot_kind').value,
                    'scale': document.getElementById('change_scaling').value,
                    'with_quantiles': document.getElementById('change_shades').checked,
                    'hidden_solvers': []
                });

                document.getElementById('unique_plot').on('plotly_legenddoubleclick', event => {
                    const solver = getSolverFromPlotlyEvent(event);
                    handleSolverDoubleClick(solver);
                });

                document.getElementById('unique_plot').on('plotly_legendclick', event => {
                    const solver = getSolverFromPlotlyEvent(event);
                    handleSolverClick(solver);
                });
            });
        </script>

        <script type="text/javascript" src="${static_dir}/result.js"></script>
    </body>
</html>
