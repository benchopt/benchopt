<%
    benchmark_name = benchmark.replace("benchmark_", "").replace("_", " ")
%>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“ˆ</text></svg>">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.tailwindcss.com"></script>

        <title>Result on ${benchmark_name} benchmark</title>

        <style>
            * {
  --switch-height: 20px;
  --switch-padding: 2px;
  --switch-width: calc((var(--switch-height) * 2) - var(--switch-padding));
  --slider-height: calc(var(--switch-height) - var(--switch-padding));
  --slider-on: calc(var(--switch-height) - var(--switch-padding));
}

.switch {
  position: relative;
  display: inline-block;
  width: var(--switch-width);
  height: var(--switch-height);
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  content: "";
  position: absolute;
  height: var(--slider-height);
  width: var(--slider-height);
  left: calc(var(--switch-padding) / 2);
  bottom: calc(var(--switch-padding) / 2);
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked+.slider {
  background-color: #2196F3;
}

input:focus+.slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked+.slider:before {
  transform: translateX(var(--slider-on));
}

.slider.round {
  border-radius: var(--slider-height);
}

.slider.round:before {
  border-radius: 50%;
}
        </style>
    </head>
    <body>
        <div class="flex">
            <div class="flex flex-col w-96 h-screen bg-gray-800">
                <div class="px-8 h-16 flex items-center">
                    <span class="text-white text-2xl">Benchopt</span>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                    <div class="mt-10 px-8">
                        <label for="dataset_selector" class="block text-sm font-medium text-white">Dataset:</label>
                        <div class="mt-1 rounded-md shadow-sm">
                            <select id="dataset_selector" class="focus:ring-blue-500 focus:border-blue-500 block w-full h-8 px-4 sm:text-sm border-gray-300 rounded-md" onchange="setState({dataset: this.value})">
                                % for data in result['dataset_names']:
                                <option value="${data}">${data}</option>
                                %endfor
                            </select>
                        </div>
                    </div>
                    <div class="mt-8 px-8">
                        <label for="objective_selector" class="block text-sm font-medium text-white">Objective:</label>
                        <div class="mt-1 rounded-md shadow-sm">
                            <select id="objective_selector" class="focus:ring-blue-500 focus:border-blue-500 block w-full h-8 px-4 sm:text-sm border-gray-300 rounded-md" onchange="setState({objective: this.value})">
                                % for obj in result['objective_names']:
                                <option value="${obj}">${obj}</option>
                                %endfor
                            </select>
                        </div>
                    </div>
                    <div class="mt-8 px-8">
                        <label for="objective_column" class="block text-sm font-medium text-white">Objective column</label>
                        <div class="mt-1 rounded-md shadow-sm">
                            <select id="objective_column" class="focus:ring-blue-500 focus:border-blue-500 block w-full h-8 px-4 sm:text-sm border-gray-300 rounded-md" onchange="setState({objective_column: this.value})">
                                % for obj_col in result['obj_cols']:
                                <option value="${obj_col}">${obj_col}</option>
                                %endfor
                            </select>
                        </div>
                    </div>
                    <div class="mt-8 px-8">
                        <label for="plot_kind" class="block text-sm font-medium text-white">Chart type</label>
                        <div class="mt-1 rounded-md shadow-sm">
                            <select id="plot_kind" class="focus:ring-blue-500 focus:border-blue-500 block w-full h-8 px-4 sm:text-sm border-gray-300 rounded-md" onchange="setState({plot_kind: this.value})">
                                % for kind in result['kinds']:
                                <option value="${kind}">${kind}</option>
                                %endfor
                            </select>
                        </div>
                    </div>
                    <div class="mt-8 px-8">
                        <label for="change_scaling" class="block text-sm font-medium text-white">Scale</label>
                        <div class="mt-1 rounded-md shadow-sm">
                            <select id="change_scaling" class="focus:ring-blue-500 focus:border-blue-500 block w-full h-8 px-4 sm:text-sm border-gray-300 rounded-md" onchange="setState({scale: this.value})">
                                <option value="semilog-y">semilog-y</option>
                                <option value="semilog-x">semilog-x</option>
                                <option value="loglog">loglog</option>
                                <option value="linear">linear</option>
                            </select>
                        </div>
                    </div>
                    <!--<div class="mt-8 px-8">
                        <label for="change_scaling" class="block text-sm font-medium text-white">Quantiles</label>
                        <div class="switch">
                            <input id="change_shades" type="checkbox" checked onchange="setState({with_quantiles: this.checked})">
                            <span class="slider round"></span>
                        </div>
                    </div>-->
                    <div class="mt-8 px-8">
                        <label for="change_scaling" class="block text-sm font-medium text-white">Quantiles</label>
                        <div>
                            <input id="change_shades" type="checkbox" checked onchange="setState({with_quantiles: this.checked})">
                        </div>
                    </div>
                </div>
            </div>
            <div class="w-full h-screen flex flex-col">
                <nav class="bg-blue-600">
                    <div class="px-4">
                        <div class="relative flex items-center justify-between h-16">
                            <div class="flex-1 flex items-center justify-center sm:items-stretch sm:justify-start">
                                <div class="hidden sm:block">
                                    <div class="flex space-x-4">
                                        <a href="${home}" class="text-gray-100 hover:bg-blue-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium" aria-current="page">Home</a>
                                        <a href="#" class="text-gray-100 hover:bg-blue-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Benchmarks</a>
                                        <a href="#" class="text-gray-100 hover:bg-blue-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Website</a>
                                        <a href="#" class="text-gray-100 hover:bg-blue-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Github</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </nav> 
    
                <div class="px-4 py-4 lg:flex lg:items-center lg:justify-between">
                    <div class="flex-1 min-w-0">
                        <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate">Result on ${benchmark_name} benchmark</h2>
                        <div class="mt-1 flex flex-col sm:flex-row sm:flex-wrap sm:mt-0 sm:space-x-6">
                            % for name, val in result['sysinfo']['main'].items():
                            % if val != "":
                            <div class="mt-2 flex items-center text-sm text-gray-500">
                                <span class="font-bold"></span>${name.upper()} : ${val}
                            </div>
                            % endif
                            % endfor
                        </div>
                    </div>
                    <div class="mt-5 flex lg:mt-0 lg:ml-4">
                        <span class="sm:ml-3">
                            <a href="${result['fname']}" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                Download CSV
                            </a>
                        </span>
                    </div>
                </div>
    
                <div id="unique_plot" class="flex-1"></div>
            </div>
        </div>

        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>
        <script>
            window.data = ${result['json']};

            window.addEventListener("load", () => {
                setState({
                    'dataset': document.getElementById('dataset_selector').value,
                    'objective': document.getElementById('objective_selector').value,
                    'objective_column': document.getElementById('objective_column').value,
                    'plot_kind': document.getElementById('plot_kind').value,
                    'scale': document.getElementById('change_scaling').value,
                    'with_quantiles': document.getElementById('change_shades').checked,
                    'hidden_curves': []
                });

                document.getElementById('unique_plot').on('plotly_legendclick', data => {
                    manageHiddenCurves(data);
                })
            });
        </script>
        <script type="text/javascript" src="${static_dir}/result.js"></script>
    </body>
</html>